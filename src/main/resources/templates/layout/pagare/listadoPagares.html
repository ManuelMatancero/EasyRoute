<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <title>Listado Pagares</title>
  <meta charset="UTF-8"/>
</head>
<body>
<section th:fragment="listadoPagares" id="pagares">
  <div class="container-fluid pt-3">
    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            <h4>[[#{pagare.listapagares}]]</h4>
          </div>
          <div th:if="${pagares != null and !pagares.empty}">
            <table id="dataTable" class="table table-stryped">
              <thead class="thead-dark">
              <tr>
                <th>#</th>
                <th th:text="#{pagare.nopagare}">No</th>
                <th th:text="#{cliente.nombre}">Nombre</th>
                <th th:text="#{pagare.capital}">Capital</th>
                <th th:text="#{pagare.interes}">Interes</th>
                <th th:text="#{pagare.total}">Total</th>
                <th th:text="#{pagare.vencimiento}">Vencimiento</th>
                <th></th>
                <th></th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="pagare, contador : ${pagares}">
                <div th:if="${pagare.reciboGen != null}">  
                  <td class="bg-success-subtle">[[${contador.count}]]</td>
                  <td class="bg-success-subtle">[[${pagare.noPagare}]]</td>
                  <td class="bg-success-subtle">[[${pagare.prestamo.cliente.nombre} + ' ' + ${pagare.prestamo.cliente.apellido}]]</td>
                  <td class="bg-success-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.capital)}]]</td>
                  <td class="bg-success-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.interes)}]]</td>
                  <td class="bg-success-subtle"><b>[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.total)}]]</b></td>
                  <td class="bg-success-subtle">[[${#temporals.format(pagare.vencimiento, 'MMMM d, yyyy')}]]</td>
                  <td class="bg-success-subtle">
                      <a sec:authorize="hasRole('ROLE_USER')" th:href="@{/paginaimprimirrecibo/} + ${pagare.idPagare}"
                         class="btn btn-warning">
                          <i class="fas fa-print"></i> [[#{barra.imprimir}]]
                      </a>
                  </td>
              </div>
              <div th:if="${pagare.reciboGen == null and pagare.vencimiento.isAfter(currentTime)}">  
                  <td class="bg-primary-subtle">[[${contador.count}]]</td>
                  <td class="bg-primary-subtle">[[${pagare.noPagare}]]</td>
                  <td class="bg-primary-subtle">[[${pagare.prestamo.cliente.nombre} + ' ' + ${pagare.prestamo.cliente.apellido}]]</td>
                  <td class="bg-primary-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.capital)}]]</td>
                  <td class="bg-primary-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.interes)}]]</td>
                  <td class="bg-primary-subtle"><b>[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.total)}]]</b></td>
                  <td class="bg-primary-subtle">[[${#temporals.format(pagare.vencimiento, 'MMMM d, yyyy')}]]</td>
                  <td class="bg-primary-subtle">
                      <a sec:authorize="hasRole('ROLE_USER')" th:href="@{/paginaimprimirrecibo/} + ${pagare.idPagare}"
                         class="btn btn-success">
                          <i class="fa-solid fa-angle-double-right"></i> [[#{pagare.pagar}]]
                      </a>
                  </td>
              </div>
              <div th:if="${pagare.vencimiento.isBefore(currentTime) and pagare.reciboGen == null}">  
                  <td class="bg-danger-subtle">[[${contador.count}]]</td>
                  <td class="bg-danger-subtle">[[${pagare.noPagare}]]</td>
                  <td class="bg-danger-subtle">[[${pagare.prestamo.cliente.nombre} + ' ' + ${pagare.prestamo.cliente.apellido}]]</td>
                  <td class="bg-danger-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.capital)}]]</td>
                  <td class="bg-danger-subtle">[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.interes)}]]</td>
                  <td class="bg-danger-subtle"><b>[[${new java.text.DecimalFormat('$#,##0.00').format(pagare.total)}]]</b></td>
                  <td class="bg-danger-subtle">[[${#temporals.format(pagare.vencimiento, 'MMMM d, yyyy')}]]</td>
                  <td class="bg-danger-subtle">
                      <a sec:authorize="hasRole('ROLE_USER')" th:href="@{/paginaimprimirrecibo/} + ${pagare.idPagare}"
                         class="btn btn-success">
                          <i class="fa-solid fa-angle-double-right"></i> [[#{pagare.pagar}]]
                      </a>
                  </td>
              </div>
              </tr>
              </tbody>
            </table>
          </div>
          <div class="text-center p-2" th:if="${pagares == null or pagares.empty}">
            <span th:text="#{persona.lista-vacia}">Lista vac√≠a</span>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>
</body>
</html>
